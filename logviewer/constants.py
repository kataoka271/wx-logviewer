import struct

LOGG = b"LOGG"
LOBJ = b"LOBJ"

FILE_HEADER_STRUCT = struct.Struct("<4sLBBBBBBBBQQLL8H8H")
OBJ_HEADER_BASE_STRUCT = struct.Struct("<4sHHLL")
LOG_CONTAINER_STRUCT = struct.Struct("<H6xL4x")
OBJ_HEADER_V1_STRUCT = struct.Struct("<LHHQ")
OBJ_HEADER_V2_STRUCT = struct.Struct("<LBxHQQ")

CAN_MESSAGE_STRUCT = struct.Struct("<HBBL")
CAN_FD_MESSAGE_STRUCT = struct.Struct("<HBBLLBBB5x")
CAN_FD_MESSAGE_64_STRUCT = struct.Struct("<BBBBLLLLLLLHBBL")
ETHERNET_FRAME_STRUCT = struct.Struct("<6sH6sHHHHH8x")
ETHERNET_FRAME_EX_STRUCT = struct.Struct("<HHHHQLHHLL")

CAN_MESSAGE = 1
CAN_ERROR = 2
LOG_CONTAINER = 10
ETHERNET_FRAME = 71
CAN_ERROR_EXT = 73
CAN_MESSAGE2 = 86
GLOBAL_MARKER = 96
CAN_FD_MESSAGE = 100
CAN_FD_MESSAGE_64 = 101
ETHERNET_FRAME_EX = 120

NO_COMPRESSION = 0
ZLIB_DEFLATE = 2

CAN_MSG_EXT = 0x80000000

# CAN_MESSAGE flags
DIR = 0x3
RTR = 0x80

# CAN_FD_MESSAGE FD flags
FDF = 0x1
BRS = 0x2
ESI = 0x4

# CAN_FD_MESSAGE_64 flags
DIR_64 = 0x00C0
DIR_64_S = 6  # 6 bits shift
RTR_64 = 0x0010
FDF_64 = 0x1000
BRS_64 = 0x2000
ESI_64 = 0x4000

# ETHERNET_FRAME_EX flags
FORWARDED = 1
VALID_HW_CHANNEL = 2
VALID_CHECKSUM = 8
VALID_FRAME_HANDLE = 0x10

TIME_TEN_MICS = 0x00000001
TIME_ONE_NANS = 0x00000002

DLC_MAP = [0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 16, 20, 24, 32, 48, 64]

VLAN_TPID_TCI_TYPE = struct.Struct(">HHH")
